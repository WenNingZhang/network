
本篇文章翻译自
http://igoro.com/archive/what-really-happens-when-you-navigate-to-a-url/

当输入 `URL` 后发生了什么? facebook.com

1. 输入URL 地址
2. 浏览器根据 DNS 查询 IP 地址
   
   而 DNS 查找过程如下:
   + 浏览器缓存 --- 浏览器会缓存**DNS**记录一段时间，有趣的是，操作系统没有告知浏览器中 **DNS** 记录的存活时间，所有浏览器会缓存DNS一个固定时间。
   + 操作系统缓存 --- 如果浏览器缓存中没有想要的 **DNS** 记录，浏览器会发起一个系统调用，因为操作系统也有自己的缓存。
   + 路由器缓存 --- 如果没有，向路由器上获取IP 地址，路由器通常会有自己的 **DNS** 缓存。
   + ISP DNS 缓存 --- 下一步去检查的是是 ISP DNS 服务器。里面有自己的缓存，再次检查是否命中。
   + 递归 查询 --- 如果还没有命中，这时 **ISP DNS** 服务器会开始递归查询，先查询根域名服务器(root)，在查询顶级域名服务器(top-level)，查询到对应的IP，
     而通常在顶级域名服务器的缓存中会有对应的 IP 地址，因此通常查询`顶级域名服务器`也是没有必要的。
3. 浏览器发送 HTTP 请求到服务器
    假如浏览器没有从浏览器`缓存`中获取数据，这时客户端发送请求到服务器

    浏览器标记`User-Agent`为相应的浏览器名称，`Accept`标记响应可以接受的格式，`Accept-Encoding`标记响应的编码，而`Connection` 的值为`Keep-Alive`,表示
    对于接下来的请求，服务器一直要保持 `TCP` 连接。

4. `facebook` 网页会响应一个永久重定向

	服务器响应一个`301`的 永久重定向 告诉浏览器 要去访问 `http://www.facebook.com/` 而不是 `http://facebook.com/`

	这是一个有趣的事情，为什么服务器响应重定向 而不是 用户想用看到的内容

	一个重要的原因是 **搜索引擎排名**，如果有两个URL 指向的是同一个页面，比如`http://www.igoro.com/ ` 和 `http://igoro.com/`，搜索引擎视这两个页面为不同的站点，
	结果造成每一个搜索链接都减少从而降低排名。所以 搜索引擎一看是`301`，把同一地址的不同链接整合为一个链接。

5. 浏览器发送请求
6. 服务器处理请求
7. 服务器发送 `HTML` 相应
	而`Content-Encoding` 的值为 `gzip` 表示告诉浏览器响应内容是使用`gzip`算法进行压缩的，在浏览器解压缩后，你将要看到正常的 HTML 页面。
	另外浏览器`Content-Type`的值为`text/html`. 表示告知浏览器渲染相应内容作为`HTML`，而不是作为一个下载文件，
	浏览器使用响应头信息去解释响应内容。
8. 浏览器开始渲染 HTML 页面。
9. 根据HTML中的内嵌对象，浏览器发送 请求。
   这里发送的请求比如 `Images`	、`js files`
10. 浏览器发送 AJAX 请求获取动态数据